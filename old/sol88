perl -e '$l=12000;sub p{my$p=1;$p*=$_ for@_;return$p}sub s{my$s=0;$s+=$_ for@_;return$s}@a=(1);while(1){$a[0]++;$p=&p(@a);$s=&s(@a);$k=$p*$a[$#a]-$s-$a[$#a]+@a+1;if((!$a[1]||$a[0]<=$a[1])&&$k<=$l){for($f=$a[$#a];($k=$p*$f-$s-$f+@a+1)<=$l;$f++){$sp=$p*$f;if(!$sp[$k]||$sp[$k]>$sp){$sp[$k]=$sp;$pp[$k]=join("*",@a,$f)}}}elsif(!$a[1]||($a[0]==2&&$a[$#a-1]==2)){last if@a>=log($l)/log(2)+10;@a=(1,(2)x@a)}else{for(0..$#a){$a[0]=$a[1];if($a[$_]==$a[$_+1]){$a[$_]=2}else{$a[$_]++;last}}$a[0]=1}}for(1..$l){$sp1[$sp[$_]]=$sp[$_];print"$_->$sp[$_] $pp[$_]\n"}$u=0;for(1..$#sp1){$u+=$sp1[$_]}print"$u\n"'
